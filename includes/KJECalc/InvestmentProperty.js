KJE.InvestmentPropertyCalc=function(){this.CANADIAN_MORTGAGE=KJE.parameters.get("CANADIAN_MORTGAGE",false);this.LOAN_2_INTERESTONLY=false;this.LOAN_1_INTERESTONLY=false;this.INTEREST_PAID2=0;this.INTEREST_PAID1=0;this.TOTAL_OF_PAYMENTS1=0;this.TOTAL_OF_PAYMENTS2=0;this.PROPERTY_INFO="";this.PROPERTY_ADDRESS="";this.DS_BALANCE=null;this.DS_LOAN2_BALANCE=null;this.cats=null;this.sSchedule=new KJE.Repeating()};KJE.InvestmentPropertyCalc.prototype.clear=function(){this.PURCHASE_PRICE=0;this.CASH_INVESTED=0;this.LOAN_1_AMOUNT=0;this.INTEREST_RATE_1=0;this.INTEREST_RATE_2=0;this.TERM_IN_MONTHS1=0;this.TERM_IN_MONTHS2=0;this.LAND_VALUE=0;this.PERSONAL_PROPERTY=0;this.BUILDING_VALUE=0;this.ANNUAL_RENT=0;this.LESS_VACANCY=0;this.PERSONAL_PROPERTY_DEPR_RATE=0;this.BUILDING_DEPR_RATE=0;this.REAL_ESTATE_TAXES=0;this.UTILITIES=0;this.INSURANCE=0;this.MAINTENANCE_REPAIRS=0;this.ADVERTISING=0;this.ADMIN_LEGAL=0;this.SUPPLIES=0;this.MISC=0;this.TAX_BRACKET=0;this.APPRECIATION_RATE=0;this.BY_YEAR=1};KJE.InvestmentPropertyCalc.prototype.calculate=function(e){var T=KJE;var E=this.PURCHASE_PRICE;var x=this.CASH_INVESTED;var ai=this.LOAN_1_AMOUNT;var ad=this.INTEREST_RATE_1;var ab=this.INTEREST_RATE_2;var s=this.TERM_IN_MONTHS1;var p=this.TERM_IN_MONTHS2;var ag=this.LAND_VALUE;var b=this.PERSONAL_PROPERTY;var aj=this.BUILDING_VALUE;var J=this.ANNUAL_RENT;var am=this.LESS_VACANCY;var az=this.PERSONAL_PROPERTY_DEPR_RATE;var D=this.BUILDING_DEPR_RATE;var h=this.REAL_ESTATE_TAXES;var O=this.UTILITIES;var aa=this.INSURANCE;var ao=this.MAINTENANCE_REPAIRS;var ah=this.ADVERTISING;var aH=this.ADMIN_LEGAL;var g=this.SUPPLIES;var av=this.MISC;var ac=this.TAX_BRACKET;var F=this.APPRECIATION_RATE;var H=this.BY_YEAR;var f=0;var k=0;var af=0;var o=E-x-ai;if(o<0){throw ("Purchase price is less than cash invested and loan 1 amount.")}var C=(this.CANADIAN_MORTGAGE?(Math.pow(1+(ad/200),(1/6))-1):ad/1200);if(this.LOAN_1_INTERESTONLY){f=T.round(C*ai,2)}else{f=T.round(KJE.PMT(C,s,ai),2)}var B=(this.CANADIAN_MORTGAGE?(Math.pow(1+(ab/200),(1/6))-1):ab/1200);if(this.LOAN_2_INTERESTONLY){k=T.round(B*o,2)}else{k=T.round(KJE.PMT(B,p,o),2)}var L=b*(az/100);var ak=aj*(D/100);var ap=L+ak;var au=J-am;var P=h+O+aa+ao+ah+aH+g+av;var aG=(au==0?0:P/au);var l=au-P;var y=(f+k)*12;var aC=l-y;var aB=0;var aE=0;var aD=0;var aA=0;var aq=ai;var Z=0;var S=0;var aw=0;var v=0;var K=0;var ae=f;var W=f;var j=ad/1200;var w=o;var N=0;var m=0;var X=0;var ay=0;var ar=0;var ax=k;var u=k;var an=ab/1200;var t=E;var R=Math.round(p>s&&o>0&&!this.LOAN_2_INTERESTONLY?p:s);if((this.LOAN_1_INTERESTONLY&&this.LOAN_2_INTERESTONLY)||(this.LOAN_1_INTERESTONLY&&o==0)){R=360}var z=this.DS_BALANCE=KJE.FloatArray(R/12+(R%12==0?1:2));var G=this.DS_LOAN2_BALANCE=KJE.FloatArray(R/12+(R%12==0?1:2));if(e){var at=this.sSchedule;at.clearRepeat();at.addHeader(at.sReportCol("Year",1),at.sReportCol("Total<br />Payments",2),at.sReportCol("Total<br />Interest paid",3),at.sReportCol("Total<br />Principle paid",4),at.sReportCol("Total Ending<br />Principle Balance",5),at.sReportCol("Investment<br />Appreciation",6),at.sReportCol("Investment<br />Return",7));at.addRepeat("&nbsp;","&nbsp;","&nbsp;","&nbsp;",T.dollars(aq+w,2),T.dollars(t,2),T.dollars(t-aq-w,2))}var r=this.cats=new Array(R/12+(R%12==0?1:2));var Q=0;r[0]="0";z[0]=(ai);G[0]=(o);var I=1;for(var M=1;M<=R;M++){Q=M-1;ax=u;N=T.round(an*w,2);m=(this.LOAN_2_INTERESTONLY?0:ax-N);w-=m;if(w==0){ax=0;m=0;N=0}else{if(w<0||(w>0.005&&R==M&&!this.LOAN_2_INTERESTONLY)){m+=w;w=0;ax=m+N}else{if(R==M&&!this.LOAN_2_INTERESTONLY){w=0}}}ae=W;Z=T.round(j*aq,2);S=(this.LOAN_1_INTERESTONLY?0:ae-Z);aq-=S;if(aq==0){ae=0;S=0;Z=0}else{if(aq<0||(aq>0.005&&R==M&&!this.LOAN_1_INTERESTONLY)){S+=aq;aq=0;ae=S+Z}else{if(R==M&&!this.LOAN_1_INTERESTONLY){w=0}}}aw+=Z;v+=S;K+=ae;aE+=Z;aD+=ae;X+=N;ay+=m;ar+=ax;aA+=ax;aB+=N;if(H!=1&&e){}if((M%12)==0||M==R){if(M==12){af=X+aw}r[I]=""+I;z[I]=(aq);G[I]=(w);I+=1;if(H==1&&e){t*=(1+F/100);at.addRepeat(T.number(I-1),T.dollars(ar+K,2),T.dollars(aw+X,2),T.dollars(v+ay,2),T.dollars(aq+w,2),T.dollars(t,2),T.dollars(t-aq+w,2))}X=0;ay=0;ar=0;aw=0;v=0;K=0}}var a=y-af;var Y=l-af-ap;var d=Y*(ac/100);var V=(F/100)*E;var aF=(aC+a-d+V)/x;var U=(aC+a-d)/x;var A=l/E;var al=aC/x;var c=aC-d;this.INTEREST_PAID1=aE;this.TOTAL_OF_PAYMENTS1=aD;this.TOTAL_OF_PAYMENTS2=aA;this.INTEREST_PAID2=aB;this.LOAN_2_AMOUNT=o;this.LOAN_1_PI=f;this.LOAN_2_PI=k;this.PERSONAL_PROPERTY_DEPRECIATION=L;this.BUILDING_DEPRECIATION=ak;this.TOTAL_DEPRECIATION=ap;this.TOTAL_OPERATING_EXPENSE=P;this.OPERATING_EXPENSE_RATIO=aG;this.GROSS_OPERATING_INCOME=au;this.ANNUAL_DEBT_SERVICE=y;this.CASH_FLOW_AFTER_TAX=c;this.CASH_FLOW_BEFORE_TAX=aC;this.ANNUAL_DEBT_SERVICE=y;this.TOTAL_INTEREST=af;this.EQUALS_PRINCIPAL_DEDUCTION=a;this.NET_OPERATING_INCOME=l;this.TAXABLE_INCOME=Y;this.TAX_PAID_OR_SAVED=d;this.TOTAL_APPRECIATION=V;this.RETURN_ON_INVESTMENT_WITH_APPRECIATION=aF;this.RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION=U;this.CAP_RATE=A;this.CASH_ON_CASH=al};KJE.InvestmentPropertyCalc.prototype.formatReport=function(b){var c=KJE;var a=this.iDecimal;var d=b;d=KJE.replace("PERSONAL_PROPERTY_DEPRECIATION",c.dollars(this.PERSONAL_PROPERTY_DEPRECIATION,2),d);d=KJE.replace("PERSONAL_PROPERTY_DEPR_RATE",c.percent(this.PERSONAL_PROPERTY_DEPR_RATE/100,2),d);d=KJE.replace("PURCHASE_PRICE",c.dollars(this.PURCHASE_PRICE,2),d);d=KJE.replace("CASH_INVESTED",c.dollars(this.CASH_INVESTED,2),d);d=KJE.replace("LOAN_1_AMOUNT",c.dollars(this.LOAN_1_AMOUNT,2),d);d=KJE.replace("INTEREST_RATE_1",c.percent(this.INTEREST_RATE_1/100,2),d);d=KJE.replace("LOAN_2_AMOUNT",c.dollars(this.LOAN_2_AMOUNT,2),d);d=KJE.replace("INTEREST_RATE_2",c.percent(this.INTEREST_RATE_2/100,2),d);d=KJE.replace("LOAN_1_PI",c.dollars(this.LOAN_1_PI,2)+(this.LOAN_1_INTERESTONLY?" Interest Only":""),d);d=KJE.replace("TERM_IN_MONTHS1",(this.LOAN_1_INTERESTONLY?"N/A":c.number(this.TERM_IN_MONTHS1)),d);d=KJE.replace("LOAN_2_PI",c.dollars(this.LOAN_2_PI,2)+(this.LOAN_2_INTERESTONLY?" Interest Only":""),d);d=KJE.replace("TERM_IN_MONTHS2",(this.LOAN_2_INTERESTONLY?"N/A":c.number(this.TERM_IN_MONTHS2)),d);d=KJE.replace("LAND_VALUE",c.dollars(this.LAND_VALUE,2),d);d=KJE.replace("BUILDING_VALUE",c.dollars(this.BUILDING_VALUE,2),d);d=KJE.replace("ANNUAL_RENT",c.dollars(this.ANNUAL_RENT,2),d);d=KJE.replace("LESS_VACANCY",c.dollars(this.LESS_VACANCY,2),d);d=KJE.replace("BUILDING_DEPR_RATE",c.percent(this.BUILDING_DEPR_RATE/100,2),d);d=KJE.replace("BUILDING_DEPRECIATION",c.dollars(this.BUILDING_DEPRECIATION,2),d);d=KJE.replace("TOTAL_DEPRECIATION",c.dollars(this.TOTAL_DEPRECIATION,2),d);d=KJE.replace("GROSS_OPERATING_INCOME",c.dollars(this.GROSS_OPERATING_INCOME,2),d);d=KJE.replace("REAL_ESTATE_TAXES",c.dollars(this.REAL_ESTATE_TAXES,2),d);d=KJE.replace("UTILITIES",c.dollars(this.UTILITIES,2),d);d=KJE.replace("INSURANCE",c.dollars(this.INSURANCE,2),d);d=KJE.replace("MAINTENANCE_REPAIRS",c.dollars(this.MAINTENANCE_REPAIRS,2),d);d=KJE.replace("ADVERTISING",c.dollars(this.ADVERTISING,2),d);d=KJE.replace("ADMIN_LEGAL",c.dollars(this.ADMIN_LEGAL,2),d);d=KJE.replace("SUPPLIES",c.dollars(this.SUPPLIES,2),d);d=KJE.replace("MISC",c.dollars(this.MISC,2),d);d=KJE.replace("TOTAL_OPERATING_EXPENSE",c.dollars(this.TOTAL_OPERATING_EXPENSE,2),d);d=KJE.replace("OPERATING_EXPENSE_RATIO",c.percent(this.OPERATING_EXPENSE_RATIO,2),d);d=KJE.replace("TAX_BRACKET",c.percent(this.TAX_BRACKET/100,2),d);d=KJE.replace("APPRECIATION_RATE",c.percent(this.APPRECIATION_RATE/100,2),d);d=KJE.replace("GROSS_OPERATING_INCOME",c.dollars(this.GROSS_OPERATING_INCOME,2),d);d=KJE.replace("NET_OPERATING_INCOME",c.dollars(this.NET_OPERATING_INCOME,2),d);d=KJE.replace("ANNUAL_DEBT_SERVICE",c.dollars(this.ANNUAL_DEBT_SERVICE,2),d);d=KJE.replace("CASH_FLOW_BEFORE_TAX",c.dollars(this.CASH_FLOW_BEFORE_TAX,2),d);d=KJE.replace("CASH_FLOW_AFTER_TAX",c.dollars(this.CASH_FLOW_AFTER_TAX,2),d);d=KJE.replace("ANNUAL_DEBT_SERVICE",c.dollars(this.ANNUAL_DEBT_SERVICE,2),d);d=KJE.replace("TOTAL_INTEREST",c.dollars(this.TOTAL_INTEREST,2),d);d=KJE.replace("EQUALS_PRINCIPAL_DEDUCTION",c.dollars(this.EQUALS_PRINCIPAL_DEDUCTION,2),d);d=KJE.replace("NET_OPERATING_INCOME",c.dollars(this.NET_OPERATING_INCOME,2),d);d=KJE.replace("TAXABLE_INCOME",c.dollars(this.TAXABLE_INCOME,2),d);d=KJE.replace("TAX_PAID_OR_SAVED",c.dollars(this.TAX_PAID_OR_SAVED,2),d);d=KJE.replace("TOTAL_APPRECIATION",c.dollars(this.TOTAL_APPRECIATION,2),d);d=KJE.replace("RETURN_ON_INVESTMENT_WITH_APPRECIATION",c.percent(this.RETURN_ON_INVESTMENT_WITH_APPRECIATION,2),d);d=KJE.replace("RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION",c.percent(this.RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION,2),d);d=KJE.replace("CAP_RATE",c.percent(this.CAP_RATE,2),d);d=KJE.replace("CASH_ON_CASH",c.percent(this.CASH_ON_CASH,2),d);d=KJE.replace("PERSONAL_PROPERTY",c.dollars(this.PERSONAL_PROPERTY,2),d);d=KJE.replace("PROPERTY_INFO",(this.PROPERTY_INFO==""?"(none entered)":this.PROPERTY_INFO),d);d=KJE.replace("PROPERTY_ADDRESS",(this.PROPERTY_ADDRESS==""?"(none entered)":this.PROPERTY_ADDRESS),d);d=d.replace("**REPEATING GROUP**",this.sSchedule.getRepeat());this.sSchedule.clearRepeat();return d};KJE.InvestmentPropertyCalc.TermDefault1=360;KJE.InvestmentPropertyCalc.TermDefault2=360;KJE.CalcName="Investment Property Calculator";KJE.CalcType="InvestmentProperty";KJE.CalculatorTitleTemplate="Investment Property Calculator";KJE.parseInputs=function(a){return a};KJE.initialize=function(){KJE.CalcControl=new KJE.InvestmentPropertyCalc();KJE.GuiControl=new KJE.InvestmentProperty(KJE.CalcControl)};KJE.InvestmentProperty=function(h){var d=KJE;var c=KJE.gLegend;var e=KJE.inputs.items;KJE.StringInput("PROPERTY_ADDRESS","Property address");KJE.StringInput("PROPERTY_INFO","Property information");KJE.DollarSlider("PURCHASE_PRICE","Purchase Price",0,100000000,0,0,4);KJE.DollarSlider("CASH_INVESTED","Cash Invested",0,100000000,0,0,4);KJE.DollarSlider("LOAN_1_AMOUNT","Loan 1 Amount",0,100000000,0,0,4,"bold");KJE.MortgageRateSlider("INTEREST_RATE_1","Interest Rate 1");KJE.MortgageRateSlider("INTEREST_RATE_2","Interest Rate 2");KJE.NumberSlider("TERM_IN_MONTHS1","Term in Months",0,360,0,12);KJE.NumberSlider("TERM_IN_MONTHS2","Term in Months",0,360,0,12);KJE.DollarSlider("LAND_VALUE","Land Value",0,100000000,0,0,4);KJE.DollarSlider("PERSONAL_PROPERTY","Personal Property",0,100000000,0,0,4);KJE.DollarSlider("BUILDING_VALUE","Building Value",0,100000000,0,0,4);KJE.DollarSlider("ANNUAL_RENT","Annual Rent",0,100000000,0,0,4);KJE.DollarSlider("LESS_VACANCY","Vacancy",0,100000000,0,0,4);KJE.PercentSlider("PERSONAL_PROPERTY_DEPR_RATE","Personal property depreciation rate",0,100,2);KJE.PercentSlider("BUILDING_DEPR_RATE","Building depreciation rate",0,100,2);KJE.DollarSlider("REAL_ESTATE_TAXES","Real Estate Taxes",0,1000000,0,0,4);KJE.DollarSlider("UTILITIES","Utilities",0,10000000,0,0,2);KJE.DollarSlider("INSURANCE","Insurance",0,10000000,0,0,2);KJE.DollarSlider("MAINTENANCE_REPAIRS","Maintenance/Repairs",0,10000000,0,0,2);KJE.DollarSlider("ADVERTISING","Advertising",0,10000000,0,0,2);KJE.DollarSlider("ADMIN_LEGAL","Admin/Legal",0,10000000,0,0,2);KJE.DollarSlider("SUPPLIES","Supplies",0,10000000,0,0,2);KJE.DollarSlider("MISC","Miscellaneous",0,10000000,0,0,2);KJE.PercentSlider("TAX_BRACKET","Tax bracket",0,100,2,0);KJE.PercentSlider("APPRECIATION_RATE","Appreciation rate",0,33,2,0);KJE.Checkbox("LOAN_2_INTERESTONLY","Interest only",false,"Check here for an interest only loan");KJE.Checkbox("LOAN_1_INTERESTONLY","Interest only",false,"Check here for an interest only loan");KJE.Label("PERSONAL_PROPERTY_DEPRECIATION","Personal property depreciation");KJE.Label("BUILDING_DEPRECIATION","Building depreciation");KJE.Label("TOTAL_DEPRECIATION","Total depreciation");KJE.Label("TOTAL_OPERATING_EXPENSE","Total operating expense");KJE.Label("OPERATING_EXPENSE_RATIO","Operating expense ratio");KJE.Label("LOAN_1_PI","Principal and Interest");KJE.Label("LOAN_2_PI","Principal and Interest");KJE.Label("LOAN_2_AMOUNT","Loan 2 Amount",null,null,"bold");KJE.Label("GROSS_OPERATING_INCOME","Gross operating income");KJE.Label("ANNUAL_DEBT_SERVICE","Annual debt service");KJE.Label("TAXABLE_INCOME","Taxable income");KJE.Label("NET_OPERATING_INCOME","Net operating income");KJE.Label("CASH_FLOW_BEFORE_TAX","Cash flow before tax");KJE.Label("CASH_FLOW_AFTER_TAX","Cash flow after-tax");KJE.Label("RETURN_ON_INVESTMENT_WITH_APPRECIATION","ROI with appreciation");KJE.Label("RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION","ROI without appreciation");KJE.Label("CAP_RATE","Cap rate");KJE.Label("CASH_ON_CASH","Cash on cash");var f=KJE.gNewGraph(KJE.gLINE,"GRAPH1",true,false,KJE.colorList[1],KJE.parameters.get("MSG_GRAPH_TITLE","Loan Balance by Year"));f._legend._iOrientation=(c.TOP_RIGHT);f._titleXAxis.setText("Year");f._titleGraph.setText("Loan Balances by Year");KJE.addDiv("PROPERTY",KJE.colorList[0]);var b=KJE.parameters.get("MSG_DROPPER_TITLE","Property Information:");KJE.addDropper(new KJE.Dropper("INPUTS",false,b,b),KJE.colorList[0]);var i=KJE.parameters.get("MSG_DROPPER2_TITLE","Financing the Purchase:");KJE.addDropper(new KJE.Dropper("INPUTS2",false,i,i),KJE.colorList[0]);var a=KJE.parameters.get("MSG_DROPPER3_TITLE","Annual Expenses:");KJE.addDropper(new KJE.Dropper("INPUTS3",false,a,a),KJE.colorList[0]);var g=KJE.parameters.get("MSG_DROPPER4_TITLE","Analyzing the Results:");KJE.addDropper(new KJE.Dropper("INPUTS4",false,g,g),KJE.colorList[0])};KJE.InvestmentProperty.prototype.setValues=function(b){var a=KJE.inputs.items;b.PROPERTY_INFO=a.PROPERTY_INFO.getValue();b.PROPERTY_ADDRESS=a.PROPERTY_ADDRESS.getValue();b.LOAN_2_INTERESTONLY=a.LOAN_2_INTERESTONLY.getValue();b.LOAN_1_INTERESTONLY=a.LOAN_1_INTERESTONLY.getValue();b.PURCHASE_PRICE=a.PURCHASE_PRICE.getValue();b.CASH_INVESTED=a.CASH_INVESTED.getValue();b.LOAN_1_AMOUNT=a.LOAN_1_AMOUNT.getValue();b.INTEREST_RATE_1=a.INTEREST_RATE_1.getValue();b.INTEREST_RATE_2=a.INTEREST_RATE_2.getValue();b.LAND_VALUE=a.LAND_VALUE.getValue();b.PERSONAL_PROPERTY=a.PERSONAL_PROPERTY.getValue();b.BUILDING_VALUE=a.BUILDING_VALUE.getValue();b.ANNUAL_RENT=a.ANNUAL_RENT.getValue();b.LESS_VACANCY=a.LESS_VACANCY.getValue();b.PERSONAL_PROPERTY_DEPR_RATE=a.PERSONAL_PROPERTY_DEPR_RATE.getValue();b.BUILDING_DEPR_RATE=a.BUILDING_DEPR_RATE.getValue();b.REAL_ESTATE_TAXES=a.REAL_ESTATE_TAXES.getValue();b.UTILITIES=a.UTILITIES.getValue();b.INSURANCE=a.INSURANCE.getValue();b.MAINTENANCE_REPAIRS=a.MAINTENANCE_REPAIRS.getValue();b.ADVERTISING=a.ADVERTISING.getValue();b.ADMIN_LEGAL=a.ADMIN_LEGAL.getValue();b.SUPPLIES=a.SUPPLIES.getValue();b.MISC=a.MISC.getValue();b.TAX_BRACKET=a.TAX_BRACKET.getValue();b.APPRECIATION_RATE=a.APPRECIATION_RATE.getValue();if(a.LOAN_2_INTERESTONLY.getValue()){a.TERM_IN_MONTHS2.disable();a.TERM_IN_MONTHS2._inputField.value=("N/A")}else{if(a.TERM_IN_MONTHS2._inputField.value==("N/A")){a.TERM_IN_MONTHS2.setText(KJE.number(360,0))}b.TERM_IN_MONTHS2=a.TERM_IN_MONTHS2.getValue();a.TERM_IN_MONTHS2.enable()}if(a.LOAN_1_INTERESTONLY.getValue()){a.TERM_IN_MONTHS1.disable();a.TERM_IN_MONTHS1._inputField.value=("N/A")}else{if(a.TERM_IN_MONTHS1._inputField.value==("N/A")){a.TERM_IN_MONTHS1.setText(KJE.number(360,0))}b.TERM_IN_MONTHS1=a.TERM_IN_MONTHS1.getValue();a.TERM_IN_MONTHS1.enable()}};KJE.InvestmentProperty.prototype.refresh=function(e){var d=KJE;var c=KJE.gLegend;var b=KJE.inputs.items;var a=KJE.gGraphs[0];KJE.setTitleTemplate("Investment Property Calculator");a.removeAll();a.setGraphCategories(e.cats);a.add(new KJE.gGraphDataSeries(e.DS_BALANCE,"Loan One",a.getColor(1)));if(e.LOAN_2_AMOUNT>0){a.add(new KJE.gGraphDataSeries(e.DS_LOAN2_BALANCE,"Loan Two",a.getColor(2)))}a.paint();b.PERSONAL_PROPERTY_DEPRECIATION.setText(d.dollars(e.PERSONAL_PROPERTY_DEPRECIATION,2));b.BUILDING_DEPRECIATION.setText(d.dollars(e.BUILDING_DEPRECIATION,2));b.TOTAL_DEPRECIATION.setText(d.dollars(e.TOTAL_DEPRECIATION,2));b.LOAN_2_AMOUNT.setText(d.dollars(e.LOAN_2_AMOUNT,2));b.LOAN_1_PI.setText(d.dollars(e.LOAN_1_PI,2));b.LOAN_2_PI.setText(d.dollars(e.LOAN_2_PI,2));b.TOTAL_OPERATING_EXPENSE.setText(d.dollars(e.TOTAL_OPERATING_EXPENSE,2));b.OPERATING_EXPENSE_RATIO.setText(d.percent(e.OPERATING_EXPENSE_RATIO,2));b.GROSS_OPERATING_INCOME.setText(d.dollars(e.GROSS_OPERATING_INCOME,2));b.ANNUAL_DEBT_SERVICE.setText(d.dollars(e.ANNUAL_DEBT_SERVICE,2));b.TAXABLE_INCOME.setText(d.dollars(e.TAXABLE_INCOME,2));b.NET_OPERATING_INCOME.setText(d.dollars(e.NET_OPERATING_INCOME,2));b.CASH_FLOW_BEFORE_TAX.setText(d.dollars(e.CASH_FLOW_BEFORE_TAX,2));b.CASH_FLOW_AFTER_TAX.setText(d.dollars(e.CASH_FLOW_AFTER_TAX,2));b.RETURN_ON_INVESTMENT_WITH_APPRECIATION.setText(d.percent(e.RETURN_ON_INVESTMENT_WITH_APPRECIATION,2));b.RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION.setText(d.percent(e.RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION,2));b.CAP_RATE.setText(d.percent(e.CAP_RATE,2));b.CASH_ON_CASH.setText(d.percent(e.CASH_ON_CASH,2))};KJE.InputScreenText=" <div id=KJE-D-PROPERTY> <div style=\"height:10px\"></div> <div id='KJE-C-PROPERTY_ADDRESS'><input id='KJE-PROPERTY_ADDRESS'></div> <div id='KJE-C-PROPERTY_INFO'><input id='KJE-PROPERTY_INFO' /></div> <div id='KJE-C-PURCHASE_PRICE'><input id='KJE-PURCHASE_PRICE' /></div> <div id='KJE-C-CASH_INVESTED'><input id='KJE-CASH_INVESTED' /></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS><div id=KJE-P-INPUTS>Input information:</div></div> <div id=KJE-E-INPUTS > <div id='KJE-C-LAND_VALUE'><input id='KJE-LAND_VALUE' /></div> <div id='KJE-C-PERSONAL_PROPERTY'><input id='KJE-PERSONAL_PROPERTY' /></div> <div id='KJE-C-BUILDING_VALUE'><input id='KJE-BUILDING_VALUE' /></div> <div id='KJE-C-ANNUAL_RENT'><input id='KJE-ANNUAL_RENT' /></div> <div id='KJE-C-LESS_VACANCY'><input id='KJE-LESS_VACANCY' /></div> <div id='KJE-C-PERSONAL_PROPERTY_DEPR_RATE'><input id='KJE-PERSONAL_PROPERTY_DEPR_RATE' /></div> <div id='KJE-C-BUILDING_DEPR_RATE'><input id='KJE-BUILDING_DEPR_RATE' /></div> <div id='KJE-C-PERSONAL_PROPERTY_DEPRECIATION'><div id='KJE-PERSONAL_PROPERTY_DEPRECIATION'></div></div> <div id='KJE-C-BUILDING_DEPRECIATION'><div id='KJE-BUILDING_DEPRECIATION'></div></div> <div id='KJE-C-TOTAL_DEPRECIATION'><div id='KJE-TOTAL_DEPRECIATION'></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS2><div id=KJE-P-INPUTS2>Input information:</div></div> <div id=KJE-E-INPUTS2 > <div id='KJE-C-LOAN_1_AMOUNT'><input id='KJE-LOAN_1_AMOUNT' /></div> <div id='KJE-C-INTEREST_RATE_1'><input id='KJE-INTEREST_RATE_1' /></div> <div id='KJE-C-TERM_IN_MONTHS1'><input id='KJE-TERM_IN_MONTHS1' /></div> <div id='KJE-C-LOAN_1_INTERESTONLY'><input id='KJE-LOAN_1_INTERESTONLY' type=checkbox name='LOAN_1_INTERESTONLY' /></div> <div id='KJE-C-LOAN_1_PI'><div id='KJE-LOAN_1_PI'></div></div> <div style=\"height:10px\"></div> <div id='KJE-C-LOAN_2_AMOUNT'><div id='KJE-LOAN_2_AMOUNT'></div></div> <div id='KJE-C-INTEREST_RATE_2'><input id='KJE-INTEREST_RATE_2' /></div> <div id='KJE-C-TERM_IN_MONTHS2'><input id='KJE-TERM_IN_MONTHS2' /></div> <div id='KJE-C-LOAN_2_INTERESTONLY'><input id='KJE-LOAN_2_INTERESTONLY' type=checkbox name='LOAN_2_INTERESTONLY' /></div> <div id='KJE-C-LOAN_2_PI'><div id='KJE-LOAN_2_PI'></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS3><div id=KJE-P-INPUTS3>Input information:</div></div> <div id=KJE-E-INPUTS3 > <div id='KJE-C-REAL_ESTATE_TAXES'><input id='KJE-REAL_ESTATE_TAXES' /></div> <div id='KJE-C-UTILITIES'><input id='KJE-UTILITIES' /></div> <div id='KJE-C-INSURANCE'><input id='KJE-INSURANCE' /></div> <div id='KJE-C-MAINTENANCE_REPAIRS'><input id='KJE-MAINTENANCE_REPAIRS' /></div> <div id='KJE-C-ADVERTISING'><input id='KJE-ADVERTISING' /></div> <div id='KJE-C-ADMIN_LEGAL'><input id='KJE-ADMIN_LEGAL' /></div> <div id='KJE-C-SUPPLIES'><input id='KJE-SUPPLIES' /></div> <div id='KJE-C-MISC'><input id='KJE-MISC' /></div> <div id='KJE-C-TOTAL_OPERATING_EXPENSE'><div id='KJE-TOTAL_OPERATING_EXPENSE'></div></div> <div id='KJE-C-OPERATING_EXPENSE_RATIO'><div id='KJE-OPERATING_EXPENSE_RATIO'></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS4><div id=KJE-P-INPUTS4>Input information:</div></div> <div id=KJE-E-INPUTS4 > <div id='KJE-C-TAX_BRACKET'><input id='KJE-TAX_BRACKET' /></div> <div id='KJE-C-APPRECIATION_RATE'><input id='KJE-APPRECIATION_RATE' /></div> <div style=\"height:10px\"></div> <div id='KJE-C-TOT_GROSS_OPERATING_INCOME'><div id='KJE-TOT_GROSS_OPERATING_INCOME'></div></div> <div id='KJE-C-NET_OPERATING_INCOME'><div id='KJE-NET_OPERATING_INCOME'></div></div> <div id='KJE-C-ANNUAL_DEBT_SERVICE'><div id='KJE-ANNUAL_DEBT_SERVICE'></div></div> <div id='KJE-C-CASH_FLOW_BEFORE_TAX'><div id='KJE-CASH_FLOW_BEFORE_TAX'></div></div> <div id='KJE-C-TAXABLE_INCOME'><div id='KJE-TAXABLE_INCOME'></div></div> <div id='KJE-C-CASH_FLOW_AFTER_TAX'><div id='KJE-CASH_FLOW_AFTER_TAX'></div></div> <div style=\"height:10px\"></div> <div id='KJE-C-RETURN_ON_INVESTMENT_WITH_APPRECIATION'><div id='KJE-RETURN_ON_INVESTMENT_WITH_APPRECIATION'></div></div> <div id='KJE-C-RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION'><div id='KJE-RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION'></div></div> <div id='KJE-C-CAP_RATE'><div id='KJE-CAP_RATE'></div></div> <div id='KJE-C-CASH_ON_CASH'><div id='KJE-CASH_ON_CASH'></div></div> </div> **GRAPH1** ";KJE.DefinitionText=" <div id='KJE-D-CASH_INVESTED' ><dt>Cash Invested</dt><dd>The cash amount out of pocket required for the purchase of this property.</dd></div> <div id='KJE-D-INTEREST_RATE' ><dt>Interest Rate</dt><dd>The amount of interest the investor pays annually to borrow money from the lender. Rates and programs can vary, check with lender for more information.</dd></div> <div id='KJE-D-LAND_VALUE' ><dt>Land Value</dt><dd>The approximate value of the land that the property sits on. Usually available on the tax records in the county the property resides. You can not deprecate land value.</dd></div> <div id='KJE-D-PERSONAL_PROPERTY' ><dt>Personal Property</dt><dd>Anything that you have that is used for the investment property, such as washer/dryer, range, refrigerator lawn equipment, fixtures and other.</dd></div> <div id='KJE-D-PERSONAL_PROPERTY_DEPR_RATE' ><dt>Personal Property Depreciation Rate</dt><dd>The rate annually you can depreciate on the personal property.</dd></div> <div id='KJE-D-BUILDING_DEPRECIATION' ><dt>Building Value Depreciation Rate</dt><dd>Recovery period for five-year personal property.<p> <div class=KJECenter><table border=1 WIDTH=50%> <tr><th width=50%>Year</th><th width=50%>Percentage</th></tr> <tr><td align=center width=50%>1</td><td align=center width=50%>20%</td></tr> <tr><td align=center width=50%>3</td><td align=center width=50%>14.20%</td></tr> <tr><td align=center width=50%>5</td><td align=center width=50%>11.52%</td></tr> <tr><td align=center width=50%>2</td><td align=center width=50%>32%</td></tr> <tr><td align=center width=50%>4</td><td align=center width=50%>11.52%</td></tr> <tr><td align=center width=50%>6</td><td align=center width=50%>5.76%</td></tr> </table></div></dd></div> <div id='KJE-D-APPRECIATION_RATE' ><dt>Appreciation</dt><dd>The amount the property is appreciating on an annual basis. Appreciation occurs on entire value of the property.</dd></div> <div id='KJE-D-LOAN_2_PI' ><dt>Loan P & I</dt><dd>P=principle, I=interest</dd></div> <div id='KJE-D-TOTAL_DEPRECIATION' ><dt>Total Depreciation</dt><dd>Total amount you can depreciate annually on personal property and building value.</dd></div> <div id='KJE-D-TOT_GROSS_OPERATING_INCOME' ><dt>Gross Operating Income</dt><dd>The amount of income available after vacancy.</dd></div> <div id='KJE-D-TOTAL_OPERATING_EXPENSE' ><dt>Total Annual Operating Expense</dt><dd>The total annual expenses including real estate tax, repairs, management fees, insurance, utilities, supplies, and other miscellaneous expenses.</dd></div> <div id='KJE-D-OPERATING_EXPENSE_RATIO' ><dt>Operating Expense Ratio</dt><dd>It's the percentage amount- based on the income 23 - 30% is considered average.</dd></div> <div id='KJE-D-NET_OPERATING_INCOME' ><dt>Net Operating Expenses</dt><dd>Total annual amount of expenses.</dd></div> <div id='KJE-D-CASH_FLOW_BEFORE_TAX' ><dt>Cash Flow Before Tax</dt><dd>What's left after expenses, principle payment and interest.</dd></div> <div id='KJE-D-ANNUAL_DEBT_SERVICE' ><dt>Annual Debt Service</dt><dd>Your payment to lender including principal and interest.</dd></div> <div id='KJE-D-RETURN_ON_INVESTMENT_WITH_APPRECIATION' ><dt>Return on Investment w/appreciation</dt><dd>Cash flow before tax + principle reduction + taxes saved/paid + appreciation divided by cash invested. Includes appreciation.</dd></div> <div id='KJE-D-RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION' ><dt>Return on Investment w/ out Appreciation</dt><dd>Cash flow before tax + principle reduction + taxes saved/paid divided by cash invested.</dd></div> <div id='KJE-D-CAP_RATE' ><dt>Cap Rate</dt><dd>Net operating income divided by price, capitalization rate, rate of return. Over 10% is considered an excellent rate.</dd></div> <div id='KJE-D-CASH_ON_CASH' ><dt>Cash on Cash</dt><dd>Cash flow before tax % cash invested.</dd></div> ";KJE.ReportText=' <!--HEADING "Investment Property Calculator" HEADING--> <h2 class=\'KJEReportHeader KJEFontHeading\'>Property Address</h2><span class="KJEBold">PROPERTY_ADDRESS</span> <h2 class=\'KJEReportHeader KJEFontHeading\'>Property Information</h2><span class="KJEBold">PROPERTY_INFO</span> **GRAPH** <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Financing Information</caption> <tr class=KJEOddRow><td class="KJELabel KJECellBorder KJECell60">Purchase Price </td><td class="KJECell KJECell40"> PURCHASE_PRICE </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Cash Invested </td><td class="KJECell"> CASH_INVESTED </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Loan #1 Amount </td><td class="KJECell"> LOAN_1_AMOUNT </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">&nbsp;&nbsp;&nbsp;Interest Rate </td><td class="KJECell"> INTEREST_RATE_1 </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">&nbsp;&nbsp;&nbsp;Monthly PI </td><td class="KJECell"> LOAN_1_PI </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">&nbsp;&nbsp;&nbsp;Term in Months </td><td class="KJECell"> TERM_IN_MONTHS1 </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Loan #2 Amount </td><td class="KJECell"> LOAN_2_AMOUNT </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">&nbsp;&nbsp;&nbsp;Interest Rate </td><td class="KJECell"> INTEREST_RATE_2 </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">&nbsp;&nbsp;&nbsp;Monthly PI </td><td class="KJECell"> LOAN_2_PI </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">&nbsp;&nbsp;&nbsp;Term in Months </td><td class="KJECell"> TERM_IN_MONTHS2 </td></tr> </table></div> <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Property & Depreciation Information</caption> <tr class=KJEOddRow><td class="KJELabel KJECellBorder KJECell60">Land Value </td><td class="KJECell KJECell40"> LAND_VALUE </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Personal Property </td><td class="KJECell"> PERSONAL_PROPERTY </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Building Value </td><td class="KJECell"> BUILDING_VALUE </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Personal property depreciation </td><td class="KJECell"> PERSONAL_PROPERTY_DEPRECIATION at PERSONAL_PROPERTY_DEPR_RATE depreciation</td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Building depreciation </td><td class="KJECell"> BUILDING_DEPRECIATION at BUILDING_DEPR_RATE depreciation</td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Total Depreciation </td><td class="KJECell"> TOTAL_DEPRECIATION </td></tr> </table></div> <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Gross Operating Income</caption> <tr class=KJEOddRow><td class="KJELabel KJECellBorder KJECell60">Annual Rent </td><td class="KJECell KJECell40"> ANNUAL_RENT </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Vacancy </td><td class="KJECell"> LESS_VACANCY </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Gross Operating Income </td><td class="KJECell"> GROSS_OPERATING_INCOME </td></tr> </table></div> <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Annual Expenses</caption> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder KJECell60">Real Estate Taxes </td><td class="KJECell KJECell40"> REAL_ESTATE_TAXES </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Utilities </td><td class="KJECell"> UTILITIES </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Insurance </td><td class="KJECell"> INSURANCE </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Maintenance/Repairs </td><td class="KJECell"> MAINTENANCE_REPAIRS </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Advertising </td><td class="KJECell"> ADVERTISING </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Admin/Legal </td><td class="KJECell"> ADMIN_LEGAL </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Supplies </td><td class="KJECell"> SUPPLIES </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Miscellaneous </td><td class="KJECell"> MISC </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Total operating expense </td><td class="KJECell"> TOTAL_OPERATING_EXPENSE </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Operating expense ratio </td><td class="KJECell"> OPERATING_EXPENSE_RATIO </td></tr> </table></div> <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Tax and Appreciation Rates</caption> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder KJECell60">Tax bracket </td><td class="KJECell KJECell40"> TAX_BRACKET </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Appreciation rate </td><td class="KJECell"> APPRECIATION_RATE </td></tr> </table></div> <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Cash Before Taxes</caption> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder KJECell60">Gross Operating Income </td><td class="KJECell KJECell40"> GROSS_OPERATING_INCOME </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Operating expense </td><td class="KJECell">- TOTAL_OPERATING_EXPENSE </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Net Operating Income </td><td class="KJECell">= NET_OPERATING_INCOME </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Annual Debt Service </td><td class="KJECell"> - ANNUAL_DEBT_SERVICE </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Cash Flow Before Tax </td><td class="KJECell"> = CASH_FLOW_BEFORE_TAX </td></tr> </table></div> <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Cash After Taxes</caption> <tr class=KJEOddRow><td class="KJELabel KJECellBorder KJECell60">Net Operating Income </td><td class="KJECell KJECell40"> NET_OPERATING_INCOME </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Total Interest </td><td class="KJECell">- TOTAL_INTEREST </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Total Depreciation </td><td class="KJECell">- TOTAL_DEPRECIATION </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Taxable Income </td><td class="KJECell">= TAXABLE_INCOME </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Tax Paid or Saved </td><td class="KJECell"> - TAX_PAID_OR_SAVED </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Cash flow after-tax </td><td class="KJECell"> CASH_FLOW_AFTER_TAX </td></tr> </table></div> <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Rates of return</caption> <tr class=KJEOddRow><td class="KJELabel KJECellBorder KJECell60">Total appreciation </td><td class="KJECell KJECell40"> TOTAL_APPRECIATION </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Return on Investment with appreciation </td><td class="KJECell"> RETURN_ON_INVESTMENT_WITH_APPRECIATION </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Return on Investment without appreciation </td><td class="KJECell"> RETURN_ON_INVESTMENT_WITHOUT_APPRECIATION </td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Cap Rate </td><td class="KJECell"> CAP_RATE </td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Cash on Cash </td><td class="KJECell"> CASH_ON_CASH </td></tr> </table></div> <h2 class=\'KJEScheduleHeader KJEFontHeading\'>Schedule</h2> **REPEATING GROUP** ';