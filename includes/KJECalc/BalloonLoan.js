KJE.BalloonLoanCalc=function(){this.ANNUAL_PERIODS=12;this.PERIOD_LABEL=KJE.parameters.get("PERIOD_LABEL","monthly");this.MSG_GRAPH_BY_YEAR=KJE.parameters.get("MSG_GRAPH_BY_YEAR","Balance by year");this.MSG_GRAPH_BY_PAYMENT=KJE.parameters.get("MSG_GRAPH_BY_PAYMENT","Balance by payment");this.MSG_YEAR_NUMBER=KJE.parameters.get("MSG_YEAR_NUMBER","Year Number");this.MSG_PAYMENT_NUMBER=KJE.parameters.get("MSG_PAYMENT_NUMBER","Payment Number");this.MSG_REPORT_LOAN=KJE.parameters.get("MSG_REPORT_LOAN","A PERIOD_LABEL payment of MONTHLY_PAYMENT at INTEREST_RATE for TERM periods will give you a loan amount of LOAN_AMOUNT.");this.MSG_REPORT_PAYMENT=KJE.parameters.get("MSG_REPORT_PAYMENT","A loan amount of LOAN_AMOUNT at INTEREST_RATE for TERM PERIOD_LABEL payments will give you a payment of MONTHLY_PAYMENT.");this.AMORTIZATION_TERM=0;this.ENDING_BALANCE=0;this.BALLOON_PAYMENT=0;this.PAYMENT_CALC=1;this.sReturnMessage="";this.ANNUAL_PERIODS=12;this.sSchedule=new KJE.Repeating()};KJE.BalloonLoanCalc.prototype.clear=function(){this.MONTHLY_PAYMENT=0;this.INTEREST_RATE=0;this.TERM=0;this.LOAN_AMOUNT=0};KJE.BalloonLoanCalc.prototype.calculate=function(v){var e=KJE;var h=this.MONTHLY_PAYMENT;var d=this.INTEREST_RATE;var r=this.LOAN_AMOUNT;var t=this.AMORTIZATION_TERM*this.ANNUAL_PERIODS;var w=this.TERM*this.ANNUAL_PERIODS;var c=0;var b=0;t=(t>0?(t<w?w:t):w);this.sReturnMessage="";if(this.PAYMENT_CALC==0){r=Math.round(KJE.PV(d/(this.ANNUAL_PERIODS*100),t,h));this.sReturnMessage=this.MSG_REPORT_LOAN}else{h=e.round(KJE.PMT(d/(this.ANNUAL_PERIODS*100),t,r),2);this.sReturnMessage=this.MSG_REPORT_PAYMENT}var k=Math.round(w);var s=0;var j=k;if(k>120){j=k/12;if((k%12)!=0){j+=1}}else{if(k>60){j=k/4;if((k%4)!=0){j+=1}}else{if(k>=36){j=k/2;if((k%2)!=0){j+=1}}}}this.DS_BALANCE=KJE.FloatArray(j);this.cats=KJE.FloatArray(j);if(v){var g=this.sSchedule;g.clearRepeat();g.addHeader(g.sReportCol("#",1),g.sReportCol("Payment",2),g.sReportCol("Principal",3),g.sReportCol("Interest",4),g.sReportCol("Loan balance",5));g.addRepeat("&nbsp;","&nbsp;","&nbsp;","&nbsp;",e.dollars(r))}var a=r;var u=0;var x=0;var f=h;this.ENDING_BALANCE=0;var m=0;var l=0;var o=true;for(var p=1;p<=k;p++){s=p-1;if(k>120){o=((s%12)==0)}else{if(k>60){o=((s%4)==0)}else{if(k>=36){o=((s%2)==0)}else{o=true}}}l=a;u=e.round((d/(this.ANNUAL_PERIODS*100))*a,2);x=h-u;a-=x;if(a<0){f+=a;a=0;x=f-u}else{f=h}if(k==p){if(a>0.005&&w==t){f+=a;a=0;x=f-u}else{if(w!=t){f+=a;a=0;x=f-u}else{a=0}}}if(o){if(k>120&&(this.ANNUAL_PERIODS==12)){this.cats[m]=""+((p+12)/12);this.DS_BALANCE[m]=(l)}else{this.cats[m]=""+p;if(p==k&&w!=t){this.DS_BALANCE[m]=(f)}else{this.DS_BALANCE[m]=(a)}}m+=1}if(k==p){if(w==t){b+=f}}else{b+=f}c+=u;if(v){g.addRepeat(e.number(p),e.dollars(f,2),e.dollars(x,2),e.dollars(u,2),e.dollars(a,2))}}this.ENDING_BALANCE=a;this.BALLOON_PAYMENT=f;this.DS_BALANCE[this.DS_BALANCE.length-1]=(this.BALLOON_PAYMENT);this.INTEREST_PAID=c;this.TOTAL_OF_PAYMENTS=b;this.AMORTIZATION_TERM=Math.round(t/this.ANNUAL_PERIODS);this.MONTHLY_PAYMENT=h;this.LOAN_AMOUNT=r;this.PAYMENT_COUNT=w};KJE.BalloonLoanCalc.prototype.formatReport=function(a){var b=KJE;var c=a;c=KJE.replace("AMORTIZATION_TERM",b.number(this.AMORTIZATION_TERM),c);c=KJE.replace("REGULAR_PAYMENTS",b.number(this.TERM*this.ANNUAL_PERIODS-1),c);c=KJE.replace("BALLOON_PAYMENT",b.dollars(this.BALLOON_PAYMENT,2),c);c=KJE.replace("RESULT_MESSAGE",this.sReturnMessage,c);c=KJE.replace("MONTHLY_PAYMENT",b.dollars(this.MONTHLY_PAYMENT,2),c);c=KJE.replace("INTEREST_RATE",b.percent(this.INTEREST_RATE/100,3),c);c=KJE.replace("TERM_YEARS",b.number(this.TERM),c);c=KJE.replace("TERM",b.number(this.TERM),c);c=KJE.replace("PERIOD_LABEL",this.PERIOD_LABEL,c);c=KJE.replace("LOAN_AMOUNT",b.dollars(this.LOAN_AMOUNT),c);c=KJE.replace("INTEREST_PAID",b.dollars(this.INTEREST_PAID,2),c);c=KJE.replace("TOTAL_OF_PAYMENTS",b.dollars(this.TOTAL_OF_PAYMENTS,2),c);c=KJE.replace("ANNUAL_PERIODS",b.number(this.ANNUAL_PERIODS),c);c=KJE.replace("ENDING_BALANCE",b.dollars(this.ENDING_BALANCE,2),c);c=c.replace("**REPEATING GROUP**",this.sSchedule.getRepeat());this.sSchedule.clearRepeat();return c};KJE.Default.AMORTIZATION_TERM_INDEX=[3,5,7,10,12,15];KJE.Default.TERM_INDEX=[3,5];KJE.CalcName="Balloon Loan Calculator";KJE.CalcType="BalloonLoan";KJE.CalculatorTitleTemplate="Loan payment is KJE2 for KJE1 payments";KJE.parseInputs=function(c){var d=new Array();var b=new Array();var e=0;for(e=0;e<KJE.Default.TERM_INDEX.length;e++){d[e]=KJE.Default.TERM_INDEX[e]+" "+KJE.MSG_YEARS_LBL}for(e=0;e<KJE.Default.AMORTIZATION_TERM_INDEX.length;e++){b[e]=KJE.Default.AMORTIZATION_TERM_INDEX[e]+" "+KJE.MSG_YEARS_LBL}var a=KJE.getDropBox("AMORTIZATION_TERM",15,KJE.Default.AMORTIZATION_TERM_INDEX,b);c=KJE.replace("**AMORTIZATION_TERM**",a,c);a=KJE.getDropBox("TERM",KJE.parameters.get("TERM",3),KJE.Default.TERM_INDEX,d);c=KJE.replace("**TERM**",a,c);return c};KJE.initialize=function(){KJE.CalcControl=new KJE.BalloonLoanCalc();KJE.GuiControl=new KJE.BalloonLoan(KJE.CalcControl)};KJE.BalloonLoan=function(f){var e=KJE;var c=KJE.gLegend;var b=KJE.inputs.items;KJE.Radioboxes("PAYMENT_CALC","Calculate",true,"Payment","Loan Amount","bold");KJE.DollarSlider("MONTHLY_PAYMENT","Monthly payment",10,100000,2,0,0);KJE.RateSlider("INTEREST_RATE","Interest rate");KJE.DollarSlider("LOAN_AMOUNT","Loan amount",100,10000000,0,0,2);KJE.DropBox("AMORTIZATION_TERM","Amortization period");KJE.DropBox("TERM","Loan term (balloon period)");KJE.Label("ENDING_BALANCE","Balloon payment",null,null,"bold");KJE.Label("TOTAL_OF_PAYMENTS","Total regular payments",null,null,"bold");KJE.Label("INTEREST_PAID","Total interest paid",null,null,"bold");var a=KJE.gNewGraph(KJE.gCOLUMN,"GRAPH1",true,false,KJE.colorList[1],KJE.parameters.get("MSG_GRAPH_TITLE","Balances for a KJE1 loan"));a._legend.setVisible(false);a._legend._iOrientation=(c.GRID_TOP_RIGHT);a._axisX.setVisible(true);a._axisY.setVisible(true);var d=KJE.parameters.get("MSG_DROPPER_TITLE","Balloon loan inputs");KJE.addDropper(new KJE.Dropper("INPUTS",true,d,d),KJE.colorList[0])};KJE.BalloonLoan.prototype.setValues=function(b){var a=KJE.inputs.items;b.PAYMENT_CALC=a.PAYMENT_CALC.getValue();if(b.PAYMENT_CALC){b.LOAN_AMOUNT=a.LOAN_AMOUNT.getValue();a.MONTHLY_PAYMENT.disable(true);a.LOAN_AMOUNT.enable()}else{b.MONTHLY_PAYMENT=a.MONTHLY_PAYMENT.getValue();a.LOAN_AMOUNT.disable(true);a.MONTHLY_PAYMENT.enable()}b.INTEREST_RATE=a.INTEREST_RATE.getValue();b.AMORTIZATION_TERM=Math.round(a.AMORTIZATION_TERM.getValue());b.TERM=Math.round(a.TERM.getValue())};KJE.BalloonLoan.prototype.refresh=function(f){var e=KJE;var c=KJE.gLegend;var b=KJE.inputs.items;var a=KJE.gGraphs[0];KJE.setTitleTemplate(e.number(f.PAYMENT_COUNT),e.dollars(f.MONTHLY_PAYMENT,2));a.removeAll();a.setGraphCategories(f.cats);if(f.TERM>120&&f.ANNUAL_PERIODS==12){a.add(new KJE.gGraphDataSeries(f.DS_BALANCE,f.MSG_GRAPH_BY_YEAR,a.getColor(1)))}else{a.add(new KJE.gGraphDataSeries(f.DS_BALANCE,f.MSG_GRAPH_BY_PAYMENT,a.getColor(1)))}a.setTitleTemplate(e.dollars(f.LOAN_AMOUNT));if(f.TERM>120){a._titleXAxis.setText(f.MSG_YEAR_NUMBER)}else{a._titleXAxis.setText(f.MSG_PAYMENT_NUMBER)}a.paint();b.LOAN_AMOUNT.setValue(f.LOAN_AMOUNT,true);b.MONTHLY_PAYMENT.setValue(f.MONTHLY_PAYMENT,true);b.ENDING_BALANCE.setText(e.dollars(f.BALLOON_PAYMENT,2));b.TOTAL_OF_PAYMENTS.setText(e.dollars(f.TOTAL_OF_PAYMENTS,2));b.INTEREST_PAID.setText(e.dollars(f.INTEREST_PAID,2));var d=KJE.Default.AMORTIZATION_TERM_INDEX;for(i=0;i<d.length;i++){if(d[i]==f.AMORTIZATION_TERM){b.AMORTIZATION_TERM.setValue(i,true);break}}};KJE.InputScreenText=" <div id=KJE-D-INPUTS><div id=KJE-P-INPUTS>Input information:</div></div> <div id=KJE-E-INPUTS > <div id='KJE-C-PAYMENT_CALC'><input type=radio id='KJE-PAYMENT_CALC1' name=KJE-PAYMENT_CALC /><input type=radio id='KJE-PAYMENT_CALC2' name=KJE-PAYMENT_CALC /></div> <div id='KJE-C-MONTHLY_PAYMENT'><input id='KJE-MONTHLY_PAYMENT' /></div> <div id='KJE-C-LOAN_AMOUNT'><input id='KJE-LOAN_AMOUNT' /></div> <div id='KJE-C-INTEREST_RATE'><input id='KJE-INTEREST_RATE' /></div> <div id='KJE-C-TERM'>**TERM**</div> <div id='KJE-C-AMORTIZATION_TERM'>**AMORTIZATION_TERM**</div> <div id='KJE-C-INTEREST_PAID'><div id='KJE-INTEREST_PAID'></div></div> <div id='KJE-C-TOTAL_OF_PAYMENTS'><div id='KJE-TOTAL_OF_PAYMENTS'></div></div> <div id='KJE-C-ENDING_BALANCE'><div id='KJE-ENDING_BALANCE'></div></div> <div style=\"height:10px\"></div> </div> **GRAPH1** ";KJE.DefinitionText=" <div id='KJE-D-LOAN_AMOUNT' ><dt>Loan amount</dt><dd>Original or expected balance for your loan.</dd></div> <div id='KJE-D-INTEREST_RATE' ><dt>Interest rate</dt><dd>Annual interest rate for this loan.</dd></div> <div id='KJE-D-TERM' ><dt>Loan term in years (balloon period)</dt><dd>The time period after which you must refinance or pay off your loan. The most common balloon loan terms are 3 years and 5 years. After the loan term is complete, you will then need to refinance or pay off the remaining balance.</dd></div> <div id='KJE-D-AMORTIZATION_TERM' ><dt>Amortization period</dt><dd>The number of years over which your loan payment is calculated.</dd></div> <div id='KJE-D-MONTHLY_PAYMENT' ><dt>Monthly payment</dt><dd>Monthly principal and interest payment (PI). The monthly payment is calculated using a term up to 15 years.</dd></div> <div id='KJE-D-TOTAL_OF_PAYMENTS' ><dt>Total payments</dt><dd>Total of all monthly payments over the term of the balloon loan. This total payment amount assumes that there are no prepayments of principal.</dd></div> <div id='KJE-D-INTEREST_PAID' ><dt>Total interest</dt><dd>Total of all interest paid over the term of the balloon loan. This total interest amount assumes that there are no prepayments of principal.</dd></div> ";KJE.ReportText=' <!--HEADING "Balloon Loan Calculator Results" HEADING--> <h2 class=\'KJEReportHeader KJEFontHeading\'>Your payment is MONTHLY_PAYMENT for TERM_YEARS years with a rate of INTEREST_RATE. </h2> Your payment of MONTHLY_PAYMENT is fixed for the TERM_YEARS year term of your balloon loan. After REGULAR_PAYMENTS regular monthly payments you will have a balloon payment of BALLOON_PAYMENT that will need to be paid off or refinanced. (Your balloon payment of BALLOON_PAYMENT does not include any prepayments.) **GRAPH** <div class=KJEReportTableDiv><table class=KJEReportTable> <tr class=KJEHeaderRow><th class=KJEHeading COLSPAN=2>Loan summary</th></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder KJECell60" >Payments</td><td class="KJECell KJECell40">REGULAR_PAYMENTS monthly payments of MONTHLY_PAYMENT<BR>1 balloon payment of BALLOON_PAYMENT</td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Loan amount</td><td class="KJECell">LOAN_AMOUNT</td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Interest rate</td><td class="KJECell">INTEREST_RATE</td></tr> <tr class=KJEEvenRow><td class="KJELabel KJECellBorder">Loan term</td><td class="KJECell">TERM_YEARS years</td></tr> <tr class=KJEOddRow><td class="KJELabel KJECellBorder">Amortization period</td><td class="KJECell">AMORTIZATION_TERM years</td></tr> <tr class=KJEFooterRow><td class="KJELabel KJECellBorder ">Total of regular payments</td><td class="KJECellStrong">TOTAL_OF_PAYMENTS</td></tr> <tr class=KJEFooterRow><td class="KJELabel KJECellBorder ">Balloon payment</td><td class="KJECellStrong">BALLOON_PAYMENT</td></tr> <tr class=KJEFooterRow><td class="KJELabel KJECellBorder ">Total interest paid</td><td class="KJECellStrong">INTEREST_PAID</td></tr></table> </div> <h2 class=\'KJEScheduleHeader KJEFontHeading\'>Payment Schedule</h2> **REPEATING GROUP** ';